# ─── Moodle ──────────────────────────────────────────────────────────────────
# Bilkent uses a different URL every semester — check the current one on the
# Bilkent website before each semester.
MOODLE_URL=https://moodle.bilkent.edu.tr/2025-2026-spring

# Moodle credentials (a session token is fetched automatically and cached)
MOODLE_USERNAME=
MOODLE_PASSWORD=

# Optional: supply a token directly instead of username/password
# MOODLE_TOKEN=

# ─── Telegram Bot ────────────────────────────────────────────────────────────
# Get a token from @BotFather on Telegram: /newbot
TELEGRAM_BOT_TOKEN=

# Your personal Telegram chat ID (use @userinfobot to find it)
TELEGRAM_OWNER_ID=

# Additional admin IDs with access to /upload and /stats (comma-separated)
# TELEGRAM_ADMIN_IDS=111222333,444555666

# ─── LLM API Keys ────────────────────────────────────────────────────────────
# At least one of Gemini or OpenAI is required.

# Google AI Studio (https://aistudio.google.com/apikey)
# Used for: main chat, teaching mode, weekly digests, practice questions
GEMINI_API_KEY=

# OpenAI (https://platform.openai.com/api-keys)
# Used for: memory extraction, planner step, critic step, topic detection
OPENAI_API_KEY=

# Optional: Z.ai GLM models as additional fallback
# GLM_API_KEY=
# GLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4

# ─── Task → Model Routing ────────────────────────────────────────────────────
# Each task type routes to the most cost-effective model.
# Override any mapping here. Defaults shown below.
MODEL_CHAT=gemini-2.5-flash          # Main agentic chat (RAG + tool loop)
MODEL_STUDY=gemini-2.5-flash         # Deep teaching mode (strict grounding)
MODEL_EXTRACTION=gpt-4.1-nano        # Planner step, critic step, memory extraction
MODEL_TOPIC_DETECT=gpt-4.1-nano      # Topic detection (cheap, fast)
MODEL_SUMMARY=gemini-2.5-flash       # Weekly digest generation
MODEL_QUESTIONS=gemini-2.5-flash     # Practice question generation
MODEL_OVERVIEW=gemini-2.5-flash      # Course overview
MODEL_COMPLEXITY=gpt-4.1-mini        # Complex query escalation target

# ─── Paths ───────────────────────────────────────────────────────────────────
# All runtime data is stored under DATA_DIR (created automatically on first run)
DATA_DIR=./data
DOWNLOADS_DIR=./data/downloads
CHROMA_DIR=./data/chromadb

# ─── Data directory layout (created automatically) ────────────────────────────
# data/
# ├── downloads/          Raw downloaded Moodle files (PDF, DOCX, PPTX)
# ├── chromadb/           FAISS vector index + metadata
# ├── cache.db            SQLite persistent cache (emails, grades, assignments)
# ├── memory.db           Conversation memory (per-user history)
# ├── .moodle_token       Cached Moodle session token
# ├── sync_state.json     Moodle sync progress tracker
# ├── study_sessions.json Study session analytics
# ├── profile.md          User profile (preferred topics, study history)
# ├── file_summaries.json LLM-generated file summaries for RAG prioritization
# ├── source_summaries/   Per-course source summaries
# └── conversation_history.json  Optional export of conversation history

# ─── Embedding ───────────────────────────────────────────────────────────────
# Downloaded from Hugging Face on first run (~500 MB). Supports 50+ languages.
EMBEDDING_MODEL=paraphrase-multilingual-MiniLM-L12-v2
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# After the model is downloaded, switch to offline mode to skip network checks:
# HF_HUB_OFFLINE=1

# ─── RAG Parameters ──────────────────────────────────────────────────────────
# RAG_SIMILARITY_THRESHOLD=0.65   # Min similarity to trigger teaching mode
# RAG_MIN_CHUNKS=2                # Min chunks required for teaching mode
# RAG_TOP_K=5                     # Max chunks returned per search

# ─── Rate Limiting ───────────────────────────────────────────────────────────
# RATE_LIMIT_MAX=30               # Max requests per window per user
# RATE_LIMIT_WINDOW=60            # Window size in seconds

# ─── Conversation Memory ─────────────────────────────────────────────────────
# MEMORY_MAX_MESSAGES=15          # Max messages kept in per-user context
# MEMORY_TTL_MINUTES=60           # Minutes before context expires

# ─── Health Check ────────────────────────────────────────────────────────────
# HEALTHCHECK_ENABLED=true
# HEALTHCHECK_HOST=0.0.0.0
# HEALTHCHECK_PORT=9090

# ─── Logging ─────────────────────────────────────────────────────────────────
# LOG_LEVEL=INFO                  # DEBUG | INFO | WARNING | ERROR

# ─── Bilkent Webmail (IMAP) ──────────────────────────────────────────────────
# Enables reading emails from Bilkent DAIS/AIRS webmail through the bot.
WEBMAIL_EMAIL=
WEBMAIL_PASSWORD=

# ─── Bilkent STARS (Student Records) ─────────────────────────────────────────
# Enables grade and attendance data from the STARS student information system.
STARS_USERNAME=
STARS_PASSWORD=
